<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

  <body>
    <metal:main fill-slot="main">

      <div metal:define-macro="main">

        <h1 class="documentFirstHeading">Tabellendaten importieren / exportieren</h1>
        <p class="descreet"></p>

        <fieldset>
          <legend>Tabelle exportieren</legend>
          <p class="descreet">
            Die Tabellendaten k&ouml;nnen als CSV-Datei exportiert werden.
            Es sollte darauf geachtet werden, dass die erste Zeile der Tabelle nicht gelöscht oder
            verändert wird, ansonsten kann der Import nicht mehr funktionieren.
          </p>
          <form method="post" class="clearfix"
                tal:attributes="action request/URL">
            <input type="submit" name="export" value="Exportieren" class="allowMultiSubmit submit" />
          </form>
        </fieldset>

        <p><br /></p>

        <fieldset>
          <legend>Tabelle importieren</legend>
          <p class="descreet">
            Laden Sie die hier exportierte und modifizierte CSV-Datei wieder hoch. Beachten Sie, dass
            es bei veränderter ersten Zeile zu Problemen kommen kann.<br />
            Die Kopfzeilen werden nicht importiert!
          </p>
          <form action="" method="post" class="clearfix"
                tal:attributes="action request/URL"
                enctype="multipart/form-data">

            <p>
              <label for="file">Bearbeitete CSV-Datei:</label>
              <input type="file" name="file" id="file" class="clearfix" />
            </p>

            <br />

            <p>
              <label for="column">Zu importierende Spalte</label>
              <select name="column" id="column" class="clearfix">
                <option value=""></option>
                <tal:columns tal:repeat="column view/get_column_options">
                  <tal:block tal:define="key python:column[0];
                                         value python:column[1]">
                    <option tal:attributes="value key"
                            tal:content="value"></option>
                  </tal:block>
                </tal:columns>
              </select>
            </p>

            <br />

            <p>
              <input type="checkbox" name="enforce" id="enforce">
              <label for="enforce">Import erzwingen</label>
            </p>

            <input type="submit" name="import" value="Importieren" class="allowMultiSubmit submit" />

          </form>
        </fieldset>

      </div>

    </metal:main>
  </body>
</html>

